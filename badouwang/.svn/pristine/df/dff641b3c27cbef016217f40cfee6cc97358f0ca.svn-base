<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<script src="__ROOT__/public/js/jquery-min.js" type="text/javascript"></script>
<style type="text/css">
    a{ text-decoration:none;}
    ul,ol {list-style:none;}
	p{ margin:0;}
   .keb-all{width:900px; border:1px #00b38a  solid; margin:0 0 8px 0; border-radius:5px;}
   .keb-all .pck{font-weight:bolder; border-bottom:1px solid #00b38a; padding-left:40px; line-height:40px; height:40px;}
   .keb-all .k-cent-y{height:37px; }
   .keb-all .k-cent-y ul{ margin-left:30px; height:20px;}
   .keb-all .k-cent-y li{ float:left; width:190px; font-size:14px; color:#333333; text-align:center; line-height:35px;}
   .keb-all .k-cent-y .cw{ border-bottom:3px solid #00b38a; color:#00b38a;}
   .keb-all .k-cent-y li:hover{ border-bottom:3px solid #00b38a; color:#00b38a; cursor:pointer;}
   .keb-all .k-cent-y li span ,.keb-all .k-cent .k-cent-y li span:hover{color: #FFCC33;}
   
   .keb-all .k-cent{ margin-bottom:40px;}
   .keb-all .k-cent .k-cent-e{ width:760px; height:220px; border:1px #C0CFCB solid; margin-left:69px; margin-bottom:20px;}
   .keb-all .k-cent .k-cent-e .k-ct-y{width:540px; float:left; border-right:1px #C0CFCB solid; height:220px;}
   /*.keb-all .k-cent .k-cent-e .k-ct-y td{ width:85px; text-align:center; line-height:32px; color:#999999;}
   .keb-all .icon{width:3px;height:3px;border-radius:3px;color:#F90;background:#F90;}*/
   .keb-all .icon{background:url(../../../public/images/home/index/yuan.png) no-repeat 3px;color:#FF7F27;}
   .keb-all .k-cent .k-cent-e .k-ct-y .tei{ color:#1E1E1E;}
   .keb-all .k-cent .k-cent-e .k-ct-e{ float:right; height:220px; width:215px;}
   .keb-all .k-cent .k-cent-e .k-ct-e .k_date{margin:10px 0 0 20px;}
   .keb-all .k-cent .k-cent-e .k-ct-e .k_date span{margin-right:20px;}
   .keb-all #prev,.keb-all #next{padding:0 5px;cursor:pointer;}
   .keb-all #prev:hover,.keb-all #next:hover{background:#888;color:#fff;}
   .keb-all .k-cent .k-cent-e .k-ct-e .k_day{text-align:center;}

   .keb-all .k-cent .k-wan{  width:760px; height:230px; border:1px #C0CFCB solid; margin-left:69px;}
   .keb-all .k-cent .k-wan .k-wp{ border-bottom:1px solid #C0CFCB;  color:#333333; font-size:14px; background:#f0f7ff; margin:0; line-height:35px; padding-left:20px;}
   .keb-all .k-cent .k-wan .k-wp span{ margin-left:90px;}
   .keb-all .k-cent .k-wan .k-w-al{ width:760px; height:130px; border-bottom:1px solid #C0CFCB;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-ay{ width:250px; height:130px; float:left; border-right:1px #C0CFCB solid; }
   .keb-all .k-cent .k-wan .k-w-al .k-w-ay img{ width:80px; height:95px; margin:15px 10px; float:left;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-ay .k-w-alf{ width:145px; float:right; font-size:12px; margin-top:20px;  color:#999999; line-height:25px;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-ay .k-w-alf .bt{ color:#333333; font-size:14px; }
   .keb-all .k-cent .k-wan .k-w-al .k-w-ae{ width:180px; height:130px; float:left; border-right:1px #C0CFCB solid;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-ae p,.keb-all .k-cent .k-wan .k-w-al .k-w-as p{ text-align:center; color:#999999; font-size:14px;  margin-top:20px;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-as{ width:180px; height:130px; float:left; border-right:1px #C0CFCB solid;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-aw{ width:145px; height:130px; float:right; text-align:center;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-aw  p{ margin-top:20px;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-aw a{color:#999999; font-size:14px;}
   .keb-all .k-cent .k-wan .k-w-al .k-w-aw a:hover{color:#FFCC33;}
   .keb-all .k-cent .k-wan .k-ph{ border-bottom:1px solid #C0CFCB;  color:#333333; font-size:14px; line-height:30px; padding-left:10px;}
   .keb-all .k-cent .k-wan .k-ps{  color:#333333; font-size:14px; line-height:30px; padding-left:10px;}
   .keb-all .k-cent .k-wan .k-ps span{ color: #FF6600;}
  .keb-all .k_uncontent{border-top:1px solid #c2c2c2;width:760px;margin:0 auto;text-align:center;font-size:12px;padding-top:20px;}
   
   .keb-all .cs-cent{  width:760px; height:230px; border:1px #C0CFCB solid; margin-left:69px; margin-bottom:40px;}
   .keb-all .cs-cent .k-wp{ border-bottom:1px solid #C0CFCB;  color:#333333; font-size:14px; background:#f0f7ff; margin:0; line-height:35px; padding-left:20px;}
   .keb-all .cs-cent .k-wp span{ margin-left:90px;}
   .keb-all .cs-cent .k-w-al{ width:760px; height:130px; border-bottom:1px solid #C0CFCB;}
   .keb-all .cs-cent .k-w-al .k-w-ay{ width:250px; height:130px; float:left; border-right:1px #C0CFCB solid; }
   .keb-all .cs-cent .k-w-al .k-w-ay img{ width:80px; height:95px; margin:15px 10px; float:left;}
   .keb-all .cs-cent .k-w-al .k-w-ay .k-w-alf{ width:145px; float:right; font-size:12px; margin-top:20px;  color:#999999; line-height:25px;}
   .keb-all .cs-cent .k-w-al .k-w-ay .k-w-alf .bt{ color:#333333; font-size:14px; }
   .keb-all .cs-cent .k-w-al .k-w-ae{ width:180px; height:130px; float:left; border-right:1px #C0CFCB solid;}
   .keb-all .cs-cent .k-w-al .k-w-ae p, .keb-all .cs-cent .k-w-al .k-w-as p{ text-align:center; color:#999999; font-size:14px;  margin-top:20px;}
   .keb-all .cs-cent .k-w-al .k-w-as{ width:180px; height:130px; float:left; border-right:1px #C0CFCB solid;}
   .keb-all .cs-cent .k-w-al .k-w-aw{ width:145px; height:130px; float:right; text-align:center;}
   .keb-all .cs-cent .k-w-al .k-w-aw  p{ margin-top:20px;}
   .keb-all .cs-cent .k-w-al .k-w-aw a{color:#999999; font-size:14px;}
   .keb-all .cs-cent .k-w-al .k-w-aw a:hover{color:#FFCC33;}
   .keb-all .cs-cent .k-ph{ border-bottom:1px solid #C0CFCB;  color:#333333; font-size:14px; line-height:30px; padding-left:10px;}
   .keb-all .cs-cent .k-ps{  color:#333333; font-size:14px; line-height:30px; padding-left:10px;}
   .keb-all .cs-cent .k-ps span{ color: #FF6600;}
   
   
   .keb-all .sad-cent{  width:760px; height:230px; border:1px #C0CFCB solid; margin-left:69px; margin-bottom:40px;}
   .keb-all .sad-cent .k-wp{ border-bottom:1px solid #C0CFCB;  color:#333333; font-size:14px; background:#f0f7ff; margin:0; line-height:35px; padding-left:20px;}
   .keb-all .sad-cent .k-wp span{ margin-left:90px;}
   .keb-all .sad-cent .k-w-al{ width:760px; height:130px; border-bottom:1px solid #C0CFCB;}
   .keb-all .sad-cent .k-w-al .k-w-ay{ width:250px; height:130px; float:left; border-right:1px #C0CFCB solid; }
   .keb-all .sad-cent .k-w-al .k-w-ay img{ width:80px; height:95px; margin:15px 10px; float:left;}
   .keb-all .sad-cent .k-w-al .k-w-ay .k-w-alf{ width:145px; float:right; font-size:12px; margin-top:20px;  color:#999999; line-height:25px;}
   .keb-all .sad-cent .k-w-al .k-w-ay .k-w-alf .bt{ color:#333333; font-size:14px; }
   .keb-all .sad-cent .k-w-al .k-w-ae{ width:180px; height:130px; float:left; border-right:1px #C0CFCB solid;}
   .keb-all .sad-cent .k-w-al .k-w-ae p, .keb-all .sad-cent .k-w-al .k-w-as p{ text-align:center; color:#999999; font-size:14px;  margin-top:20px;}
   .keb-all .sad-cent .k-w-al .k-w-as{ width:180px; height:130px; float:left; border-right:1px #C0CFCB solid;}
   .keb-all .sad-cent .k-w-al .k-w-aw{ width:145px; height:130px; float:right; text-align:center;}
   .keb-all .sad-cent .k-w-al .k-w-aw  p{ margin-top:20px;}
   .keb-all .sad-cent .k-w-al .k-w-aw a{color:#999999; font-size:14px;}
   .keb-all .sad-cent .k-w-al .k-w-aw a:hover{color:#FFCC33;}
   .keb-all .sad-cent .k-ph{ border-bottom:1px solid #C0CFCB;  color:#333333; font-size:14px; line-height:30px; padding-left:10px;}
   .keb-all .sad-cent .k-ps{ color:#333333; font-size:14px; line-height:30px; padding-left:10px;}
   .keb-all .sad-cent .k-ps span{ color:#FF6600;}
   
 
 
   .keb-all .wad-cent{  width:760px; height:230px; border:1px #C0CFCB solid; margin-left:69px; margin-bottom:40px;}
   .keb-all .wad-cent .k-wp{ border-bottom:1px solid #C0CFCB;  color:#333333; font-size:14px; background:#f0f7ff; margin:0; line-height:35px; padding-left:20px;}
   .keb-all .wad-cent .k-wp span{ margin-left:90px;}
   .keb-all .wad-cent .k-w-al{ width:760px; height:130px; border-bottom:1px solid #C0CFCB;}
   .keb-all .wad-cent .k-w-al .k-w-ay{ width:250px; height:130px; float:left; border-right:1px #C0CFCB solid; }
   .keb-all .wad-cent .k-w-al .k-w-ay img{ width:80px; height:95px; margin:15px 10px; float:left;}
   .keb-all .wad-cent .k-w-al .k-w-ay .k-w-alf{ width:145px; float:right; font-size:12px; margin-top:20px;  color:#999999; line-height:25px;}
   .keb-all .wad-cent .k-w-al .k-w-ay .k-w-alf .bt{ color:#333333; font-size:14px; }
   .keb-all .wad-cent .k-w-al .k-w-ae{ width:180px; height:130px; float:left; border-right:1px #C0CFCB solid;}
   .keb-all .wad-cent .k-w-al .k-w-ae p, .keb-all .wad-cent .k-w-al .k-w-as p{ text-align:center; color:#999999; font-size:14px;  margin-top:20px;}
   .keb-all .wad-cent .k-w-al .k-w-as{ width:180px; height:130px; float:left; border-right:1px #C0CFCB solid;}
   .keb-all .wad-cent .k-w-al .k-w-aw{ width:145px; height:130px; float:right; text-align:center;}
   .keb-all .wad-cent .k-w-al .k-w-aw  p{ margin-top:20px;}
   .keb-all .wad-cent .k-w-al .k-w-aw a{color:#999999; font-size:14px;}
   .keb-all .wad-cent .k-w-al .k-w-aw a:hover{color:#FFCC33;}
   .keb-all .wad-cent .k-ph{ border-bottom:1px solid #C0CFCB;  color:#333333; font-size:14px; line-height:30px; padding-left:10px;}
   .keb-all .wad-cent .k-ps{ color:#333333; font-size:14px; line-height:30px; padding-left:10px;}
   .keb-all .wad-cent .k-ps span{ color:#FF6600;}

/*确定约课弹框*/
.skey-back{background:#c2c2c2;opacity:0.6; position:absolute;top:0;left:0;right:0;bottom:0;z-index:998;display:none;}
.skey-all{background:#fff;border:1px #C0CFCB solid;width:400px; position:absolute;display:none;z-index:999;}
.skey-all .cg-y{ background:#f5f5f5; height:40px; line-height:40px; color:#333333; font-size:12px; border-bottom:1px #C0CFCB solid; padding-left:10px;}
.skey-all .yke{ color:#999999; font-size:12px; text-align:center; margin:20px 0px;}
.skey-all .ceh{ height:65px; margin-top:15px;}
.skey-all .ceh p{  font-size:12px; text-align:center; border-radius:6px; line-height:25px; margin:10px; width:50px; padding:5px;  float:left; margin-left:80px; border:1px #C0CFCB solid;}
.skey-all .ceh p:hover{ background:#fc9f31; color:#FFF; cursor:pointer;}
   
   
</style>
</head>

<body>
   <div class="keb-all">
        <p class="pck">我的课表</p>
        
        
             <div class="k-cent-y">
                <ul>
                 <li class="kecy cw" id="kcdjy">课程日历</li>
                 <li class="kecy" id="kcdje">待确定约课 <span><{$sum}></span></li>
                 <li class="kecy" id="kcdjs">待上课 <span>0</span></li>
                 <li class="kecy" id="kcdjw">待确定酬劳  <span>0</span></li>
                 </ul>
             </div>
        
      <!-- 课程日历-->     
          <div class="k-cent" style="display:block;">
           <div class="k-cent-e">
                <div class="k-ct-y">
                  <{$calendar.table}>
                </div>
                <div class="k-ct-e">
                  <div class="k_date">
                    <span class="current" id="prev"><</span>
                    <span class="date"></span>
                    <span class="current" id="next">></span>
                  </div>
                  <div class="k_day"></div>
                </div>
           </div>

          <div id="sched">
            <if condition="$data">
              <foreach name="data" item="vo">
              <div class="k-wan">
                <p class="k-wp"><{$vo.bm_time|date="Y-m-d",###}>  <span>约课单号：<{$vo.order_num}></span>  <span><if condition="$_GET['from']">学生<else/>老师</if>：<{$vo.real_name}></span> </p>
                <div class="k-w-al">
                  <div class="k-w-ay">
                    <img src="__ROOT__<{$vo.id_front}>" />
                    <div class="k-w-alf">
                       <p class="bt"><{$vo.course}></p>
                       <p><{$vo.place}></p>
                    </div>
                  </div>
                  
                  <div class="k-w-ae">
                    <?php $b_date=strtotime($vo['date']);$end_time=(int)$vo['begin_time']+$vo['classhour']?>
                    <p><{$b_date|date="m月d日",###}></p>
                    <p><{$vo.begin_time}>-<{$end_time}>:00</p>
                    <p><{$vo.classhour}> 小时</p>
                  </div>
                  
                  <div class="k-w-as">
                    <if condition="$vo.cuid eq session('uid')"><p>待<if condition="$_GET['from']">学生<else/>老师</if>确定</p><else/>
                      <p>发起时间</p>
                      <p><{$vo.ctime|date="m月d日 H:i",###}></p>
                    </if>
                  </div>
                  
                  <div class="k-w-aw">
                    <if condition="$vo.cuid neq session('uid')"><p><a href="javascript:confirmCourse(<{$vo.yid}>)" style="color:#0C941E;">确定约课</a></p></if>
                    <p><a href="javascript:">修改时间</a></p>
                    <p><a href="javascript:">取消约课</a></p>
                  </div>
                </div>
                <p class="k-ph">上课地址：<{$vo.k_addr}></p>
                <p class="k-ps"><span>备注：</span><{$vo.k_msg}></p>
             </div>
          </foreach>
          <else/><div class="k_uncontent">没有相关课程哦~~</div></if>
        </div>

        </div>

    </div>
<!-- 确定约课 -->
<div class="skey-back"></div>
<div class="skey-all">
  <p class="cg-y">确定约课</p><p class="yke">是否确定这次约课？</p>
  <div class="ceh"><p id="confirm">确定</p><p id="cancel">取消</p></div>
  <input type="hidden" id="yid" name="yid" value="" />
</div>


<script type="text/javascript">
var c_tag = "<{$Think.get.status}>"?"<{$Think.get.status}>":1;
if(c_tag=='1'){ $(".k-cent-e").css('display','block'); }else{ $(".k-cent-e").css('display','none'); } var c_ind = parseInt(c_tag)-1; $('.kecy').removeClass("cw"); $(".kecy:eq("+c_ind+")").addClass('cw');

/*插入圆点*/
if("<{$schedule}>"){
  var schedule = eval(<?php echo json_encode($schedule)?>),len = schedule.length;
  for(var i=0;i<len;i++){
    var node = $(".getCalendar[data-value="+schedule[i].date+"]");
    node.html(node.text()+"<i class='icon'>·</i>").css({'cursor':'pointer','padding-left':'13px','width':'62px'});}
}

$('.kecy').click(function(){
  var cw = $(this).attr("id"),status = "";
  switch(cw){ case 'kcdjy': status=1;break; case 'kcdje': status=2;break; case 'kcdjs': status=3;break; case 'kcdjw': status=4;break; }
  location.href = "<{$Think.get.from}>"?"?from=teacher&status="+status:"?status="+status;
})

/*日历事件--begin--*/
$(".k-cent").attr({'onselectstart':"return false"});
$(".k_date>.date").html("<{$calendar.date}>");
var day = "",data_day = new Array(),cY = parseInt($(".bd_today").attr("data-year")),cM = parseInt($(".bd_today").attr("data-month"));
data_day = ['周日','周一','周二','周三','周四','周五','周六'];
$(".k_day").html("<span style='font-size:7em;color:#777;'>"+$(".bd_today").attr("data-date")+"</span>"+data_day[$(".bd_today").attr("data-day")]);

function setDate(ns){ var tt = ns.substr(5,5).replace(/-/,'月')+'日';return tt;}
$(".getCalendar").live('click',function(){
  day = $(this).attr('data-day'); $(".getCalendar").removeClass('aclick'); $(this).addClass('aclick'); $(".k_day").html("<span style='font-size:7em;color:#777;'>"+$(this).attr("data-date")+"</span>"+data_day[day]); $("#sched").html("");
  /*返回当天的课程*/
  if($(this).find("i").attr("class") === "icon"){
    var xdate = $(this).attr("data-value");
    $.post("__APP__/Ajax/AjaxUser/schedule",{xdate:xdate},function(data){
        if(data){
          for(var i=0;i<data.length;i++){
            var node = '<div class="k-wan"><p class="k-wp"><{$vo.bm_time|date="Y-m-d",###}>  <span>约课单号：'+data[i].order_num+'</span>  <span>老师：曾老师</span> </p><div class="k-w-al"><div class="k-w-ay"><img src="__ROOT__/public/images/home/u127.jpg" /><div class="k-w-alf"><p class="bt">'+data[i].course+'</p><p>'+data[i].place+'</p></div></div><div class="k-w-ae"><p>'+setDate(data[i].date)+'</p><p>12：00-13：00</p><p>'+data[i].classhour+' 小时</p></div><div class="k-w-as"><p>待老师确定</p></div><div class="k-w-aw"><p><a href="javascript:">修改时间</a></p><p><a href="javascript:">取消约课</a></p></div></div><p class="k-ph">上课地址：'+data[i].address+'</p><p class="k-ps"><span>备注：</span>'+data[i].msg+'</p></div>';
            $(node).appendTo("#sched");
          }
       }
    },'json');
  }
});

//$.ajaxSetup({async:false});
$(".current").click(function(){
  var id = $(this).attr("id"); if(id === "prev"){cM--;if(cM<1){cM = 12;cY--;}}else if(id === "next"){cM++;if(cM>12){cM = 1;cY++;}} $("#sched").html("");
  $.post("__APP__/Ajax/AjaxUser/Calendar",{cy:cY,cm:cM},function(data){
    if(data){ $(".k-ct-y").html(data.calendar.table); $(".k_date>.date").html(data.calendar.date); $(".k_day").html("");}
    if(data.schedule){ var lens = data.schedule.length;
      for(var i=0;i<lens;i++){ var node = $(".getCalendar[data-value="+data.schedule[i].date+"]"); node.html(node.text()+"<i class='icon'>·</i>").css({'cursor':'pointer','padding-left':'13px','width':'62px'});}}
  },'json');
});
/*日历事件--end--*/

/*确定约课*/
$("#yid").wrap('<form id="sub_yid" action="__URL__/kebiao" method="post"></from>');
function confirmCourse(id){
  var mLoc = boxLocation(".skey-all");
  $(".skey-back").css('height',$(document).height()+'px').show();$(".skey-all").css({'top':mLoc.top,'left':mLoc.left}).show(); $("#cancel").click(function(){$(".skey-back").hide();$(".skey-all").hide();});$("#confirm").click(function(){$("#yid").attr("value",id);$("#sub_yid").submit();});
}
function boxLocation(id){
  var pageW = $(window).width(), pageH = $(window).height(), boxW = $(id).outerWidth(),boxH = $(id).outerHeight(),scrollH = $(window).scrollTop(),Loc = ({'top':(pageH/2-boxH/2+scrollH)+'px','left':(pageW/2-boxW/2)+'px'});return Loc;
}

</script>

</body>
</html>
